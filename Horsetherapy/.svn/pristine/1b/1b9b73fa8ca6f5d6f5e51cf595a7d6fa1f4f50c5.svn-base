package sepm.ss13.e0828.dao;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class Connector {

	private static Connection conn = null;
	private static final String JDBCDRIVER = "org.hsqldb.jdbc.JDBCDriver";

	private Connector(){}
	
	public static void openConnection(){

		if( conn == null ){
			try {
				Class.forName(JDBCDRIVER);

				conn = DriverManager.getConnection(
						"jdbc:hsqldb:hsql://localhost/horsetherapy", "SA", ""
						);	
				//TODO say that connection was established "Logger"
			} catch (SQLException e) {
				System.err.println("Could not gather connection!");
				conn = null;
			} catch (ClassNotFoundException e) {
				System.err.println("Error: failed to load HSQL JDBC driver.");
				e.printStackTrace();
				return;
			}
		}
	}

	public static Connection getConnection(){
		if( conn != null ){
			return conn;
		}else{
			openConnection();
			return conn;
		}
	}
	
	public static void closeConnection(){
		
		if( conn != null ){
			try {
				conn.close();
				// TODO say that connection is closed now "Logger"
				conn = null;
			} catch (SQLException e) {
				System.err.println("Problem with closing connection!");
			}

		}else{
			// TODO say that connection already closed
		}
		
	}

}
